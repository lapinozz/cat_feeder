(()=>{"use strict";const n=JSON.parse('{"enums":{"Commands":{"_ESP_BEGIN":0,"ESP_Capture":0,"ESP_Dispense":1,"ESP_SetDispensingSetting":2,"ESP_SaveDispensingSettings":3,"ESP_WifiList":4,"ESP_WifiStatus":5,"ESP_WifiConnect":6,"ESP_Temperature":7,"_ESP_END":8,"_ESP_COUNT":8,"_ARD_BEGIN":9,"ARD_Dispense":9,"ARD_Reservoir":10,"_ARD_END":11,"_ARD_COUNT":2},"PaddleActions":{"_BEGIN":0,"CLOCKWISE":0,"COUNTER_CLOCKWISE":1,"JIGGLE":2,"_END":3,"_COUNT":3},"Lasers":{"_BEGIN":0,"CHUTE":0,"RESERVOIR":1,"_END":2,"_COUNT":2},"DispensingEventSettings":{"_BEGIN":0,"Amount":0,"Time":1,"Positions":2,"_END":3,"_COUNT":3},"ShiftOutputs":{"_BEGIN":0,"ChuteLaser":0,"ReservoirLaser":1,"MotorA":2,"MotorB":3,"_END":4,"_COUNT":4},"DispensingResult":{"_BEGIN":0,"Started":0,"Ok":1,"NoOutput":2,"PaddleStuck":3,"FoodJammed":4,"_END":5,"_COUNT":5}},"constants":{"DispensingEventMax":4,"PositionCount":3}}');function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t(n)}function e(n,t){var e="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=function(n,t){if(n){if("string"==typeof n)return r(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(n,t):void 0}}(n))||t&&n&&"number"==typeof n.length){e&&(n=e);var o=0,a=function(){};return{s:a,n:function(){return o>=n.length?{done:!0}:{done:!1,value:n[o++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){e=e.call(n)},n:function(){var n=e.next();return s=n.done,n},e:function(n){l=!0,i=n},f:function(){try{s||null==e.return||e.return()}finally{if(l)throw i}}}}function r(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function o(n,r){"object"==t(n)&&(r=n,n="div");var o=document.createElement(n);for(var a in r){var i=r[a];if("class"==a||"classes"==a||"classList"==a){"string"==typeof i&&(i=i.split(" "));var s,l=e(i);try{for(l.s();!(s=l.n()).done;){var c=s.value;(c=c.trim())&&o.classList.add(c.trim())}}catch(n){l.e(n)}finally{l.f()}}else if("style"==a)if("string"==typeof i)o.style=i;else for(var u in i)o.style[u]=i[u];else"parent"==a?i.appendChild(o):"text"==a?o.textContent=i:o[a]=i}return window.componentHandler&&window.componentHandler.upgradeElement(o),o}function a(n,t){var e="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=i(n))||t&&n&&"number"==typeof n.length){e&&(n=e);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){e=e.call(n)},n:function(){var n=e.next();return s=n.done,n},e:function(n){l=!0,a=n},f:function(){try{s||null==e.return||e.return()}finally{if(l)throw a}}}}function i(n,t){if(n){if("string"==typeof n)return s(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?s(n,t):void 0}}function s(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}window.downloadToFile=function(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/plain",r=new Blob([n],{type:e});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r,t);else{var o=document.createElement("a");o.download=t;var a=URL.createObjectURL(r);o.href=a,document.body.appendChild(o),o.click(),setTimeout((function(){document.body.removeChild(o),window.URL.revokeObjectURL(a)}),0)}};var l,c=n.enums,u=n.constants,p=c.Commands,f=o({parent:document.body,class:"root"}),d=o({parent:f,class:"img-container ut-flex-v"}),v=(o("img",{parent:d,class:"saved-img",src:"http://cat.lapinozz.com/saved-photo"}),o("img",{parent:d,class:"stream-img"})),g=o({parent:f,class:"wifi-container ut-flex-v"}),m=o({parent:g,class:"ut-text-input-container wifi-status-bar"}),y=(o({parent:m,class:"ut-label",text:"Status: "}),o({parent:m,class:"ut-label",text:"Connected"}),o("input",{parent:m,class:"connect",type:"button",value:"Wifi List",onclick:function(){return X()}}),o({parent:g,class:"wifi-list ut-flex-v ut-flex-expand",contentEditable:"false"})),b=o({parent:g,class:"wifi-connect-container ut-text-input-container"}),S=(o({parent:b,class:"ut-label",text:"SSID"}),o("input",{parent:b})),h=o({parent:g,class:"wifi-connect-container ut-text-input-container"}),w=(o({parent:h,class:"ut-label",text:"Password"}),o("input",{parent:h,type:"password"})),E=(o("input",{parent:h,class:"connect",type:"button",value:"Connect",onclick:function(){return G()}}),o({parent:f,class:"dispensing-events-container ut-flex-h"})),_=o({parent:f,class:"secret-container ut-text-input-container"}),C=(o({parent:_,class:"secret-label ut-label",text:"Code"}),o("input",{parent:_,class:"secret-input",type:"password"})),x=o("input",{parent:_,class:"connect",type:"button",value:"Connect"}),D=o({parent:f,class:"log ut-readonly ut-flex-expand",readOnly:!0,contentEditable:!1}),O=o({parent:f,class:"command-container ut-text-input-container"}),L=(o({parent:O,class:"command-label ut-label",text:"Command"}),o("input",{parent:O,class:"command-input ut-flex-expand"})),I=o("input",{parent:O,class:"command-send",type:"button",value:"Send"});function N(n,t){o({parent:D,class:"log-msg",text:n,style:"color: "+t}),D.scrollTop=D.scrollHeight}function k(n,t){N(n+"\n",t)}function A(n,t){N("< "+n+"\n",t)}C.value=localStorage.getItem("secret")||"",C.onchange=function(){localStorage.setItem("secret",C.value)},C.onkeydown=function(n){13==n.keyCode&&U()},L.onkeydown=function(n){13==n.keyCode&&H()},I.onclick=function(){return H()},console.log({sharedJson:n});var P=!1,T=!1;function R(){x.classList.toggle("disabled",P||T),O.classList.toggle("disabled",!P)}R(),setInterval((function(){l&&l.send("ping")}),2e3);var U=function(){l&&l.onclose();var n="ws://"+window.location.host+window.location.pathname+"ws/";window.webpackChunkwebpack_template&&(n="ws://home.lapinozz.com:4560/ws/"),l=new WebSocket(n+C.value),k("[WS] Conneting to: "+n+"XXXXXXXXXXXX"),P=!1,T=!0,R(),l.onopen=function(n){k("[WS] Connected","green"),P=!0,T=!1,R()},l.onmessage=function(n){if(n.data instanceof Blob)URL.revokeObjectURL(v.src),v.src=URL.createObjectURL(n.data);else{N("> "+n.data+"\n",undefined);var t=n.data.split(",").map((function(n){return parseInt(n)})),e=t.splice(0,1)[0];if(e==p.ESP_SetDispensingSetting){j=[];for(var r=0;r<u.DispensingEventMax;r++){j[r]=[];for(var o=0;o<c.DispensingEventSettings._COUNT;o++)j[r][o]=t[r*c.DispensingEventSettings._COUNT+o]}W()}else e==p.ESP_WifiList&&(B=n.data.split(",").slice(1).join("").split("+").map((function(n){return n.split("$")})),M())}},l.onclose=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};k("[WS] Connection Closed"+(n.reason?": "+n.reason:""),n.wasClean?"":"red"),l.onopen=void 0,l.onmessage=void 0,l.onclose=void 0,l.close(),l=null,P=!1,T=!1,R()}},j=[],W=function(){E.innerHTML="";var n=o("table",{parent:E,class:"dispensing-table"}),t=o("tr",{parent:n});o("td",{parent:t});var e,r=Object.keys(c.DispensingEventSettings).filter((function(n){return"_"!=n[0]})),i=a(r);try{for(i.s();!(e=i.n()).done;){var s=e.value;"_"!=s[0]&&o("td",{parent:t,class:"dispensing-table-header-"+s,innerText:s})}}catch(n){i.e(n)}finally{i.f()}for(var l=[],f=function(){for(var n=!1,t=0;t<j.length;t++)for(var e=0;e<r.length;e++)n=n||j[t][e]!=l[t][e];m.classList.toggle("disabled",!n)},d=function(t){var e=j[t];l[t]=[];for(var i=o("tr",{parent:n,class:"dispensing-event-container"}),s=(o("td",{parent:i,class:"dispensing-setting-container"}),function(n){var s=e[n];l[t][n]=s;var p=o("td",{parent:i,class:"dispensing-setting-container dispensing-table-"+r[n]}),d=o("input",{parent:p,class:"dispensing-setting-input"});if(n==c.DispensingEventSettings.Time)d.type="time",d.value=new Date(1e3*s).toISOString().substring(11,16),d.onchange=function(){var e=d.value.split(":").reverse().reduce((function(n,t,e){return n+t*Math.pow(60,e+1)}),0);l[t][n]=e,f()};else if(n==c.DispensingEventSettings.Amount)d.type="number",d.min=0,d.max=5,d.value=s,d.onchange=function(){var e=Math.min(100,Math.max(0,parseInt(d.value)));l[t][n]=e,f()};else if(n==c.DispensingEventSettings.Positions){d.remove();for(var v=[],g=function(){var e,r=0,o=a(v);try{for(o.s();!(e=o.n()).done;){var i=e.value;r<<=1,i.checked&&(r+=1)}}catch(n){o.e(n)}finally{o.f()}l[t][n]=r,f()},m=0;m<u.PositionCount;m++){var y=o("input",{parent:p,class:"dispensing-setting-input",type:"checkbox",checked:s>>m&1});y.onchange=g,v.push(y)}}}),p=0;p<r.length;p++)s(p)},v=0;v<j.length;v++)d(v);var g=o({parent:E,class:"ut-flex-v",style:"align-self:end"}),m=o("input",{type:"button",parent:g,class:"set-dispensing-events-button",value:"Save",onclick:function(){for(var n=0;n<j.length;n++)for(var t=0;t<r.length;t++){var e=j[n][t],o=l[n][t];e!=o&&(j[n][t]=o,H([p.ESP_SetDispensingSetting,n,t,o].join(",")))}H(p.ESP_SaveDispensingSettings),f()}});o("input",{type:"button",parent:g,class:"set-dispensing-events-button",value:"Dispense",onclick:function(){return H([p.ARD_Dispense,1,1].join(","))}}),f()},B=[],M=function(){y.innerHTML="";var n,t=a(B);try{var e=function(){var t,e,r=(t=n.value,e=3,function(n){if(Array.isArray(n))return n}(t)||function(n,t){var e=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var r,o,a=[],i=!0,s=!1;try{for(e=e.call(n);!(i=(r=e.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(n){s=!0,o=n}finally{try{i||null==e.return||e.return()}finally{if(s)throw o}}return a}}(t,e)||i(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=(r[0],r[1]);r[2],o({parent:y,class:"wifi-element",text:a}).onclick=function(){S.value=a}};for(t.s();!(n=t.n()).done;)e()}catch(n){t.e(n)}finally{t.f()}},X=function(){y.innerHTML="",o({parent:y,class:"wifi-spinner spinner"}),f.classList.toggle("wifi-open"),f.classList.contains("wifi-open")&&H([p.ESP_WifiList].join(","))},G=function(){var n=S.value,t=w.value;H(p.ESP_WifiConnect+","+n+"$"+t),X()};x.onclick=U,U();var H=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;void 0===n&&(n=L.value,L.value=""),A(n),l.send(n)}})();